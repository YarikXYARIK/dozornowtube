<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DozorNowTube</title>
    <style>
        /* --- –ï–î–ò–ù–ê–Ø –¢–ï–ú–ê: –°–ï–†–´–ô –§–û–ù, –†–û–ó–û–í–´–ô –ê–ö–¶–ï–ù–¢ --- */
        :root {
            --primary-color: #ff2a6d; /* –Ø—Ä–∫–æ-—Ä–æ–∑–æ–≤—ã–π –∞–∫—Ü–µ–Ω—Ç */
            --secondary-color: #d10047; /* –ë–æ–ª–µ–µ —Ç–µ–º–Ω—ã–π —Ä–æ–∑–æ–≤—ã–π –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ */
            --bg-main: #1c1c2e; /* –ì–ª–∞–≤–Ω—ã–π —Ñ–æ–Ω (–¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π/—Å–∏–Ω–∏–π) */
            --bg-secondary: #282840; /* –§–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Å–∞–π–¥–±–∞—Ä–∞ */
            --text-main: #ffffff; /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
            --text-secondary: #cccccc; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π –¥–ª—è –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ */
            --border-color: #3e3e60; /* –ì—Ä–∞–Ω–∏—Ü—ã */
            --icon-color: var(--primary-color); /* –ò–∫–æ–Ω–∫–∏ —Ü–≤–µ—Ç–æ–º –∞–∫—Ü–µ–Ω—Ç–∞ */
        }
        
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', Arial, sans-serif; }
        
        body { 
            background-color: var(--bg-main); 
            color: var(--text-main); 
            display: flex; 
            flex-direction: column;
            min-height: 100vh;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏–∫–æ–Ω–æ–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –∫—Ä–∞—Å–∏–≤–æ */
        .app-icon {
            font-size: 18px;
            width: 25px;
            text-align: center;
            color: var(--icon-color);
            line-height: 1; 
            display: inline-block;
        }
        .app-icon-large {
            font-size: 24px;
            margin-right: 10px;
        }


        /* Header */
        header { 
            background-color: var(--bg-secondary); 
            padding: 10px 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 2px solid var(--primary-color); 
            position: sticky; 
            top: 0; 
            z-index: 100; 
            width: 100%; 
        }
        .logo { display: flex; align-items: center; font-size: 24px; font-weight: bold; color: var(--primary-color); cursor: pointer; }
        
        .search-bar { display: flex; flex: 0 1 600px; }
        .search-bar input { 
            width: 100%; 
            padding: 8px 15px; 
            background-color: var(--bg-main); 
            border: 1px solid var(--primary-color); 
            color: var(--text-main); 
            border-radius: 20px 0 0 20px; 
            outline: none; 
        }
        .search-bar button { 
            padding: 8px 15px; 
            background-color: var(--primary-color); 
            border: none; 
            border-radius: 0 20px 20px 0; 
            color: white; 
            cursor: pointer; 
        }
        .user-actions { display: flex; align-items: center; }
        .user-actions button { 
            background: none; 
            border: none; 
            color: var(--text-main); 
            margin-left: 15px; 
            cursor: pointer; 
            font-size: 16px; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
        }

        /* Layout */
        .container { 
            display: flex; 
            max-width: 1400px; 
            margin: 0 auto; 
            flex: 1; 
            width: 100%;
        }
        .sidebar { 
            min-width: 240px; 
            background-color: var(--bg-secondary); 
            padding: 20px 0; 
            height: calc(100vh - 60px); 
            position: sticky; 
            top: 60px; 
            overflow-y: auto; 
            border-right: 1px solid var(--border-color);
        }
        .sidebar-item { padding: 10px 20px; display: flex; align-items: center; cursor: pointer; transition: 0.3s; }
        .sidebar-item:hover { background-color: rgba(40, 40, 64, 0.1); } 
        .sidebar-item.active { background-color: rgba(40, 40, 64, 0.2); border-right: 3px solid var(--primary-color); }
        .sidebar-item .app-icon { margin-right: 15px; }

        .main-content { flex: 1; padding: 20px; }
        .section-title { margin-bottom: 20px; font-size: 24px; color: var(--primary-color); }

        /* Video Grid */
        .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .video-card { 
            background-color: var(--bg-secondary); 
            border-radius: 8px; 
            overflow: hidden; 
            transition: transform 0.3s; 
            cursor: pointer; 
            border: 1px solid var(--border-color);
        }
        .video-card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); 
        }
        .thumbnail { width: 100%; height: 180px; background-color: #222; position: relative; overflow: hidden; }
        .thumbnail img { width: 100%; height: 100%; object-fit: cover; }
        .duration { position: absolute; bottom: 10px; right: 10px; background-color: rgba(0, 0, 0, 0.7); padding: 2px 6px; border-radius: 4px; font-size: 12px; }
        .video-info { padding: 10px; }
        .video-title { font-weight: bold; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .channel-info { display: flex; align-items: center; margin-top: 8px; font-size: 14px; color: var(--text-secondary); }
        .channel-avatar { 
            width: 30px; 
            height: 30px; 
            border-radius: 50%; 
            background-color: var(--primary-color); 
            margin-right: 8px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            color: white; 
            font-size: 12px;
        }
        .video-stats { color: var(--text-secondary); font-size: 13px; margin-top: 5px; }

        /* Featured Player Styles (VK Embed Fix) */
        .featured-player {
            margin-bottom: 40px; 
            border: 2px solid var(--primary-color); 
            border-radius: 10px; 
            overflow: hidden;
            background-color: #000;
        }
        .featured-player iframe {
            display: block; 
        }

        /* Styles for EMBED PLAYER in video-player-container */
        .embedded-video-player {
            width: 100%; 
            height: 500px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è iframe, —á—Ç–æ–±—ã –æ–Ω –Ω–µ —Å—Ö–ª–æ–ø—ã–≤–∞–ª—Å—è */
            background: #000; 
            border-radius: 8px;
        }


        /* Pages logic (Hidden by default) */
        .video-player-container, .channel-page, .auth-modal, .upload-modal, .admin-panel { display: none; }

        /* Player Styles */
        .real-video-player { width: 100%; background: #000; border-radius: 8px; max-height: 600px; }
        .video-controls { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid var(--border-color); }
        .action-btn { background: none; border: none; color: var(--text-main); cursor: pointer; display: flex; align-items: center; gap: 5px; margin-right: 15px; font-size: 16px;}
        .action-btn:hover { color: var(--primary-color); }
        .subscribe-btn { padding: 10px 20px; background-color: var(--primary-color); border: none; border-radius: 20px; color: white; cursor: pointer; font-weight: bold; margin-left: auto; }
        .subscribe-btn.subscribed { background-color: var(--text-secondary); }

        /* Comments */
        .comments-section { margin-top: 20px; }
        .comment-form { display: flex; gap: 10px; margin-bottom: 20px; }
        .comment-input { flex: 1; padding: 10px; background: var(--bg-secondary); border: 1px solid var(--border-color); color: var(--text-main); border-radius: 4px; }
        .comment-submit { padding: 0 20px; background: var(--primary-color); border: none; color: white; border-radius: 4px; cursor: pointer; }
        .comment { border-bottom: 1px solid var(--border-color); padding: 10px 0; display: flex; gap: 10px; }
        .comment:last-child { border-bottom: none; }

        /* Admin & Modals */
        .auth-modal, .upload-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; display: flex; }
        .auth-modal.hidden, .upload-modal.hidden { display: none; } 
        .auth-form, .upload-form { background: var(--bg-secondary); padding: 30px; border-radius: 10px; width: 400px; border: 1px solid var(--primary-color); color: var(--text-main); }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; }
        .form-group input, .form-group textarea { width: 100%; padding: 10px; background: var(--bg-main); border: 1px solid var(--border-color); color: var(--text-main); border-radius: 4px; }
        .auth-btn, .upload-btn { width: 100%; padding: 10px; background: var(--primary-color); border: none; color: white; cursor: pointer; margin-top: 10px; }
        .close-modal { float: right; cursor: pointer; font-size: 20px; color: var(--text-secondary); }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { display: none; } 
            .search-bar { display: none; }
        }
    </style>
</head>
<body>

    <div class="auth-modal hidden" id="auth-modal">
        <div class="auth-form">
            <span class="close-modal" onclick="toggleModal('auth-modal')">&times;</span>
            <h2>–í—Ö–æ–¥</h2>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω</label>
                <input type="text" id="login-input" placeholder="admin">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="pass-input" placeholder="1234">
            </div>
            <button class="auth-btn" onclick="login()">–í–æ–π—Ç–∏</button>
            <p style="margin-top:10px; font-size:12px; color:gray;">(–¢–µ—Å—Ç: –ª–æ–≥–∏–Ω <b>admin</b>, –ø–∞—Ä–æ–ª—å <b>1234</b>)</p>
        </div>
    </div>

    <div class="upload-modal hidden" id="upload-modal">
        <div class="upload-form">
            <span class="close-modal" onclick="toggleModal('upload-modal')">&times;</span>
            <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</h2>
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input type="text" id="upload-title">
                <input type="hidden" id="upload-author" value="Admin Dozor">
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="upload-desc"></textarea>
            </div>
            <div class="form-group">
                <label>–§–∞–π–ª (–≤—ã–±–µ—Ä–∏—Ç–µ mp4)</label>
                <input type="file" id="upload-file" accept="video/*">
            </div>
            <button class="upload-btn" onclick="uploadVideo()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>

    <header>
        <div class="logo" onclick="showPage('home-page')">
            <span class="app-icon-large">‚ñ∂</span>
            <span>DozorNowTube</span>
        </div>
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫...">
            <button onclick="searchVideos()">üîç</button>
        </div>
        <div class="user-actions" id="auth-buttons">
            <button onclick="toggleModal('auth-modal')"><span class="app-icon">üë§</span> –í–æ–π—Ç–∏</button>
        </div>
        <div class="user-actions" id="user-buttons" style="display:none;">
            <button onclick="toggleModal('upload-modal')"><span class="app-icon">üì§</span></button>
            <button onclick="showPage('channel-page')"><span class="app-icon">üë®‚Äçüíª</span></button>
            <button onclick="logout()"><span class="app-icon">üö™</span></button>
        </div>
    </header>

    <div class="container">
        <div class="sidebar">
            <div class="sidebar-item active" onclick="showPage('home-page')">
                <span class="app-icon">üè†</span> <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </div>
            <div class="sidebar-item">
                <span class="app-icon">üî•</span> <span>–í —Ç—Ä–µ–Ω–¥–µ</span>
            </div>
            <div class="sidebar-item">
                <span class="app-icon">üï∞Ô∏è</span> <span>–ò—Å—Ç–æ—Ä–∏—è</span>
            </div>
        </div>

        <div class="main-content" id="home-page">
            <h2 class="section-title" style="margin-bottom: 10px;">–õ—É—á—à–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–Ω—è</h2> 
            
            <div class="featured-player">
                <iframe src="https://vkvideo.ru/video_ext.php?oid=-211169870&id=456242051&autoplay=1" 
                        width="100%" 
                        height="500" 
                        style="background-color: #000;" 
                        allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" 
                        frameborder="0" 
                        allowfullscreen>
                </iframe>
            </div>
            <h2 class="section-title">–ï—â—ë —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
            <div class="video-grid" id="video-grid">
            </div>
        </div>

        <div class="main-content video-player-container" id="player-page" style="display:none;">
            <div id="player-area">
                <video id="main-video-player" class="real-video-player" controls autoplay></video>
                </div>
            
            <div class="video-info">
                <h2 id="player-title" style="margin-top:10px;">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ</h2>
                <div class="video-controls">
                    <div style="display:flex;">
                        <button class="action-btn" onclick="likeVideo()"><span class="app-icon">üëç</span> <span id="like-count">0</span></button>
                        <button class="action-btn"><span class="app-icon">üîó</span> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                    </div>
                    <button class="subscribe-btn" id="sub-btn" onclick="toggleSubscribe()">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
                </div>
                <div style="background: var(--bg-secondary); padding: 15px; border-radius: 8px; margin-top:10px; border: 1px solid var(--border-color);">
                    <p id="player-desc">–û–ø–∏—Å–∞–Ω–∏–µ –≤–∏–¥–µ–æ...</p>
                </div>

                <div class="comments-section">
                    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
                    <div class="comment-form">
                        <input type="text" class="comment-input" id="comment-text" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">
                        <button class="comment-submit" onclick="addComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                    <div id="comments-list">
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content channel-page" id="channel-page" style="display:none;">
            <div style="display:flex; align-items:center; margin-bottom:30px;">
                <div class="channel-avatar" style="width:100px; height:100px; font-size:40px;">U</div>
                <div>
                    <h1 id="channel-name">User Name</h1>
                    <p style="color:var(--text-secondary);">0 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                </div>
            </div>
            <h2>–ú–æ–∏ –≤–∏–¥–µ–æ</h2>
            <div class="video-grid" id="my-videos-grid">
                <p style="color:var(--text-secondary);">–í—ã –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –≤–∏–¥–µ–æ.</p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. –î–ê–ù–ù–´–ï (–ò–º–∏—Ç–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö) ---
        let videos = [
            {
                id: 1,
                title: "Big Buck Bunny - 3D Cartoon",
                desc: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ Blender Foundation.",
                src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                thumbnail: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Big_buck_bunny_poster_big.jpg/800px-Big_buck_bunny_poster_big.jpg",
                views: "1.2M",
                author: "Blender",
                likes: 1500
            },
            {
                id: 2,
                title: "Sintel - –§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∏–ª—å–º",
                desc: "–¢—Ä–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ –¥—Ä–∞–∫–æ–Ω–µ.",
                src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4",
                thumbnail: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Sintel_poster.jpg/640px-Sintel_poster.jpg",
                views: "800K",
                author: "Blender",
                likes: 900
            },
            {
                id: 3,
                title: "Tears of Steel - SciFi",
                desc: "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞ —Å –∫—Ä—É—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π.",
                src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4",
                thumbnail: "https://mango.blender.org/wp-content/uploads/2013/05/01_thom_celia_bridge.jpg",
                views: "2.5M",
                author: "Tears Studio",
                likes: 3000
            },
            {
                id: 4,
                title: "Subaru Outback - Off-road drive",
                desc: "–¢–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ 4K.",
                src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndOffRoad.mp4",
                thumbnail: "https://img.youtube.com/vi/D9n0Y1vJ1hU/maxresdefault.jpg",
                views: "500K",
                author: "Test Drive",
                likes: 600
            },
            // –ù–û–í–û–ï VK EMBED –í–ò–î–ï–û
            {
                id: 5,
                title: "–û–ë–ó–û–†: –°–µ–∫—Ä–µ—Ç–Ω—ã–π —Ä–æ–ª–∏–∫ –æ—Ç DozorNow",
                desc: "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è iframe-–ø–ª–µ–µ—Ä–∞.",
                src: "https://vkvideo.ru/video_ext.php?oid=-230360961&id=456239056&autoplay=1",
                thumbnail: "https://via.placeholder.com/300x180?text=VK+Dozor",
                views: "30K",
                author: "DozorNow Channel",
                likes: 250,
                isEmbed: true // –§–ª–∞–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —á—Ç–æ —ç—Ç–æ iframe, –∞ –Ω–µ <video>
            }
        ];

        let currentUser = null; 
        let comments = []; 

        // --- 2. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
        window.onload = function() {
            renderVideos(videos);
        };
        
        // --- 3. –§–£–ù–ö–¶–ò–ò –û–¢–†–ò–°–û–í–ö–ò ---
        function renderVideos(videoList) {
            const grid = document.getElementById('video-grid');
            grid.innerHTML = '';

            videoList.forEach(video => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.onclick = () => openPlayer(video);

                // –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É "—Å—Å—ã–ª–∫–∞/VK", –µ—Å–ª–∏ —ç—Ç–æ iframe
                const embedIcon = video.isEmbed ? '<span style="position: absolute; top: 10px; left: 10px; background-color: var(--primary-color); padding: 3px 6px; border-radius: 4px; font-size: 12px; font-weight: bold;">VK üîó</span>' : '';

                card.innerHTML = `
                    <div class="thumbnail">
                        <img src="${video.thumbnail}" alt="${video.title}" onerror="this.src='https://via.placeholder.com/300x180?text=No+Image'">
                        ${embedIcon}
                        <span class="duration">10:00</span>
                    </div>
                    <div class="video-info">
                        <div class="video-title">${video.title}</div>
                        <div class="channel-info">
                            <div class="channel-avatar">${video.author[0]}</div>
                            <span>${video.author}</span>
                        </div>
                        <div class="video-stats">${video.views} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ ‚Ä¢ 1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥</div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // --- 4. –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function showPage(pageId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('player-page').style.display = 'none';
            document.getElementById('channel-page').style.display = 'none';
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Å–∞–π–¥–±–∞—Ä-—ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));

            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–ª–µ–µ—Ä –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const playerArea = document.getElementById('player-area');
            playerArea.innerHTML = '<video id="main-video-player" class="real-video-player" controls autoplay></video>';


            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é
            document.getElementById(pageId).style.display = (pageId === 'player-page') ? 'block' : 'block';

            if(pageId === 'home-page') {
                document.getElementById('home-page').style.display = 'block';
                // –î–µ–ª–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø—É–Ω–∫—Ç "–ì–ª–∞–≤–Ω–∞—è"
                document.querySelector('.sidebar-item').classList.add('active');
            }
        }

        function toggleModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
            } else {
                modal.classList.add('hidden');
            }
        }

        // --- 5. –õ–û–ì–ò–ö–ê –ü–õ–ï–ï–†–ê ---
        function openPlayer(video) {
            showPage('player-page');
            const playerArea = document.getElementById('player-area');
            
            // –û—á–∏—â–∞–µ–º –æ–±–ª–∞—Å—Ç—å –ø–ª–µ–µ—Ä–∞
            playerArea.innerHTML = '';
            
            if (video.isEmbed) {
                // –ï—Å–ª–∏ —ç—Ç–æ iframe (VK, YouTube –∏ —Ç.–¥.)
                playerArea.innerHTML = `
                    <iframe src="${video.src}" 
                        class="embedded-video-player"
                        allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" 
                        frameborder="0" 
                        allowfullscreen>
                    </iframe>
                `;
            } else {
                // –ï—Å–ª–∏ —ç—Ç–æ –æ–±—ã—á–Ω—ã–π MP4 —Ñ–∞–π–ª
                playerArea.innerHTML = `<video id="main-video-player" class="real-video-player" controls autoplay src="${video.src}"></video>`;
            }


            document.getElementById('player-title').innerText = video.title;
            document.getElementById('player-desc').innerText = video.desc;
            document.getElementById('like-count').innerText = video.likes;

            renderComments();
        }

        function likeVideo() {
            let count = document.getElementById('like-count');
            count.innerText = parseInt(count.innerText) + 1;
            event.currentTarget.style.color = 'var(--primary-color)';
        }

        function toggleSubscribe() {
            const btn = document.getElementById('sub-btn');
            if(btn.innerText === "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è") {
                btn.innerText = "–í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã";
                btn.classList.add('subscribed');
            } else {
                btn.innerText = "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è";
                btn.classList.remove('subscribed');
            }
        }

        // --- 6. –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ---
        function login() {
            const loginInput = document.getElementById('login-input').value;
            const passInput = document.getElementById('pass-input').value;

            if(loginInput === 'admin' && passInput === '1234') {
                currentUser = { name: "Admin Dozor", login: "admin" };
                document.getElementById('auth-buttons').style.display = 'none';
                document.getElementById('user-buttons').style.display = 'flex';
                document.getElementById('channel-name').innerText = currentUser.name;
                toggleModal('auth-modal');
                alert("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ö–æ–¥–µ—Ä!");
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å! (–ü–æ–ø—Ä–æ–±—É–π admin / 1234)");
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('auth-buttons').style.display = 'flex';
            document.getElementById('user-buttons').style.display = 'none';
            showPage('home-page');
        }

        // --- 7. –ó–ê–ì–†–£–ó–ö–ê –í–ò–î–ï–û (–ò–ú–ò–¢–ê–¶–ò–Ø) ---
        function uploadVideo() {
            const title = document.getElementById('upload-title').value;
            const desc = document.getElementById('upload-desc').value;
            const fileInput = document.getElementById('upload-file');

            if (title && fileInput.files[0]) {
                const file = fileInput.files[0];
                const fileURL = URL.createObjectURL(file); 

                const newVideo = {
                    id: Date.now(),
                    title: title,
                    desc: desc,
                    src: fileURL,
                    thumbnail: 'https://via.placeholder.com/300x180?text=New+Video', 
                    views: "0",
                    author: currentUser ? currentUser.name : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",
                    likes: 0
                };

                videos.unshift(newVideo); 
                renderVideos(videos);
                
                toggleModal('upload-modal');
                alert("–í–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ!");
                showPage('home-page');
            } else {
                alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");
            }
        }

        // --- 8. –ü–û–ò–°–ö ---
        function searchVideos() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const filtered = videos.filter(v => v.title.toLowerCase().includes(query));
            renderVideos(filtered);
        }

        // --- 9. –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò ---
        function addComment() {
            const text = document.getElementById('comment-text').value;
            if(!text) return;
            if(!currentUser) {
                alert("–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!");
                return;
            }

            comments.push({ user: currentUser.name, text: text });
            document.getElementById('comment-text').value = '';
            renderComments();
        }

        function renderComments() {
            const list = document.getElementById('comments-list');
            list.innerHTML = '';
            comments.forEach(c => {
                const item = document.createElement('div');
                item.className = 'comment';
                item.innerHTML = `
                    <div class="channel-avatar" style="min-width:30px;">${c.user[0]}</div>
                    <div>
                        <div style="font-weight:bold; font-size:13px;">${c.user}</div>
                        <div style="font-size:14px;">${c.text}</div>
                    </div>
                `;
                list.appendChild(item);
            });
        }
    </script>
</body>
</html>
